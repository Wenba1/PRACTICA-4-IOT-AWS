SELECT topic(3) AS thing_name, substring(topic(3), 16, 22) AS serial_number, substring(topic(3), 0, 15) AS thing_type, state.reported.lid_open AS lid_open FROM '$aws/things/+/shadow/update' WHERE substring(topic(3), 0, 15) = "smart_trash_can" AND state.reported.motion_detected = true AND state.reported.lid_open = false AND ( state.reported.filling_state = "empty" OR state.reported.filling_state = "half_full" ) AND state.reported.automatic_mode = true